<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add network analysis metrics to user profiles — add_metrics • blueskynet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add network analysis metrics to user profiles — add_metrics"><meta name="description" content="Computes and adds comprehensive network analysis metrics to user profile data.
This function calculates centrality measures, community detection, and PageRank
scores to identify influential users and network structure within your Bluesky
social network."><meta property="og:description" content="Computes and adds comprehensive network analysis metrics to user profile data.
This function calculates centrality measures, community detection, and PageRank
scores to identify influential users and network structure within your Bluesky
social network."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">blueskynet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lassehjorthmadsen/blueskynet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add network analysis metrics to user profiles</h1>
      <small class="dont-index">Source: <a href="https://github.com/lassehjorthmadsen/blueskynet/blob/main/R/algos.R" class="external-link"><code>R/algos.R</code></a></small>
      <div class="d-none name"><code>add_metrics.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes and adds comprehensive network analysis metrics to user profile data.
This function calculates centrality measures, community detection, and PageRank
scores to identify influential users and network structure within your Bluesky
social network.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_metrics</span><span class="op">(</span><span class="va">profiles</span>, <span class="va">net</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-profiles">profiles<a class="anchor" aria-label="anchor" href="#arg-profiles"></a></dt>
<dd><p>Tibble. User profile information from \code\linkget_profiles
containing at least handle and other profile details</p></dd>


<dt id="arg-net">net<a class="anchor" aria-label="anchor" href="#arg-net"></a></dt>
<dd><p>Tibble. Network edge list with follow relationships containing:</p><dl><dt>actor_handle</dt>
<dd><p>Character. User who is following another</p></dd>

<dt>follows_handle</dt>
<dd><p>Character. User being followed</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Tibble with original profile data enhanced with network metrics:
\describe
\itemcentralityNumeric. Betweenness centrality score (influence as bridge)
\itemcommunityInteger. Community assignment from cluster analysis
\itempageRankNumeric. PageRank score (influence based on follower quality)
\iteminsideFollowersInteger. Number of followers within this network
\itemcommunity_labelCharacter. Descriptive label for the community

Plus all original profile columns (handle, displayName, description, etc.)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs several network analysis computations:
\itemize
\itemBetweenness centrality: Identifies users who act as bridges between communities
\itemCommunity detection: Uses random walks to find densely connected groups
\itemPageRank: Measures influence based on follower network quality
\itemInside followers: Counts followers within the analyzed network subset
\itemCommunity labels: Generates descriptive labels using TF-IDF of user bios</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>\code\linkbuild_network, \code\linkcom_labels,
\code\linkcreate_widget</p>
<p>Other network-analysis:
<code><a href="com_labels.html">com_labels</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Build a network first</span></span></span>
<span class="r-in"><span><span class="va">auth</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_token.html">get_token</a></span><span class="op">(</span><span class="st">"your.handle.bsky.social"</span>, <span class="st">"your-app-password"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">network_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="build_network.html">build_network</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  key_actors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scientist.bsky.social"</span>, <span class="st">"researcher.bsky.social"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  keywords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"science"</span>, <span class="st">"research"</span>, <span class="st">"academic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  token <span class="op">=</span> <span class="va">auth</span><span class="op">$</span><span class="va">accessJwt</span>,</span></span>
<span class="r-in"><span>  refresh_tok <span class="op">=</span> <span class="va">auth</span><span class="op">$</span><span class="va">refreshJwt</span>,</span></span>
<span class="r-in"><span>  threshold <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add comprehensive metrics to profiles</span></span></span>
<span class="r-in"><span><span class="va">enhanced_profiles</span> <span class="op">&lt;-</span> <span class="fu">add_metrics</span><span class="op">(</span><span class="va">network_result</span><span class="op">$</span><span class="va">profiles</span>, <span class="va">network_result</span><span class="op">$</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine the most central (influential) users</span></span></span>
<span class="r-in"><span><span class="va">top_central</span> <span class="op">&lt;-</span> <span class="va">enhanced_profiles</span><span class="op">[</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">enhanced_profiles</span><span class="op">$</span><span class="va">centrality</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"displayName"</span>, <span class="st">"handle"</span>, <span class="st">"centrality"</span>, <span class="st">"pageRank"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">top_central</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find the most influential users by PageRank</span></span></span>
<span class="r-in"><span><span class="va">top_pagerank</span> <span class="op">&lt;-</span> <span class="va">enhanced_profiles</span><span class="op">[</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">enhanced_profiles</span><span class="op">$</span><span class="va">pageRank</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"displayName"</span>, <span class="st">"handle"</span>, <span class="st">"pageRank"</span>, <span class="st">"followersCount"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">top_pagerank</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Analyze community structure</span></span></span>
<span class="r-in"><span><span class="va">community_summary</span> <span class="op">&lt;-</span> <span class="va">enhanced_profiles</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">community</span>, <span class="va">community_label</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    members <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    avg_followers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">followersCount</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    avg_centrality <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">centrality</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">members</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">community_summary</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find users who bridge communities (high centrality)</span></span></span>
<span class="r-in"><span><span class="va">bridge_users</span> <span class="op">&lt;-</span> <span class="va">enhanced_profiles</span><span class="op">[</span></span></span>
<span class="r-in"><span>  <span class="va">enhanced_profiles</span><span class="op">$</span><span class="va">centrality</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">enhanced_profiles</span><span class="op">$</span><span class="va">centrality</span>, <span class="fl">0.9</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"displayName"</span>, <span class="st">"handle"</span>, <span class="st">"centrality"</span>, <span class="st">"community_label"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bridge_users</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare internal vs external influence</span></span></span>
<span class="r-in"><span><span class="va">influence_comparison</span> <span class="op">&lt;-</span> <span class="va">enhanced_profiles</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">handle</span>, <span class="va">followersCount</span>, <span class="va">insideFollowers</span>, <span class="va">pageRank</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    external_followers <span class="op">=</span> <span class="va">followersCount</span> <span class="op">-</span> <span class="va">insideFollowers</span>,</span></span>
<span class="r-in"><span>    influence_ratio <span class="op">=</span> <span class="va">insideFollowers</span> <span class="op">/</span> <span class="va">followersCount</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">influence_ratio</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">influence_comparison</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lasse Hjorth Madsen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

